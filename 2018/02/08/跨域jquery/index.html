<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 跨域问题以及jquery跨域 · my blog</title><meta name="description" content="跨域问题以及jquery跨域 - liuhaosen"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="my blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">跨域问题以及jquery跨域</h1><div class="post-info">Feb 8, 2018</div><div class="post-content"><h3 id="跨域问题以及jquery跨域"><a href="#跨域问题以及jquery跨域" class="headerlink" title="跨域问题以及jquery跨域"></a>跨域问题以及jquery跨域</h3><h4 id="1-什么是跨域"><a href="#1-什么是跨域" class="headerlink" title="1.什么是跨域"></a>1.什么是跨域</h4><p>跨域，指的是浏览器不能执行其他网站的脚本。它是由浏览器的同源策略造成的，是浏览器对javascript施加的安全限制。<br>所谓同源是指，域名，协议，端口均相同，不明白没关系，举个栗子：<br><a href="http://www.123.com/index.html" target="_blank" rel="external">http://www.123.com/index.html</a> 调用 <a href="http://www.123.com/server.php" target="_blank" rel="external">http://www.123.com/server.php</a> （非跨域）<br><a href="http://www.123.com/index.html" target="_blank" rel="external">http://www.123.com/index.html</a> 调用 <a href="http://www.456.com/server.php" target="_blank" rel="external">http://www.456.com/server.php</a> （主域名不同:123/456，跨域）<br><a href="http://abc.123.com/index.html" target="_blank" rel="external">http://abc.123.com/index.html</a> 调用 <a href="http://def.123.com/server.php" target="_blank" rel="external">http://def.123.com/server.php</a> （子域名不同:abc/def，跨域）<br><a href="http://www.123.com:8080/index.html" target="_blank" rel="external">http://www.123.com:8080/index.html</a> 调用 <a href="http://www.123.com:8081/server.php" target="_blank" rel="external">http://www.123.com:8081/server.php</a> （端口不同:8080/8081，跨域）<br><a href="http://www.123.com/index.html" target="_blank" rel="external">http://www.123.com/index.html</a> 调用 <a href="https://www.123.com/server.php" target="_blank" rel="external">https://www.123.com/server.php</a> （协议不同:http/https，跨域）<br>请注意：localhost和127.0.0.1虽然都指向本机，但也属于跨域。<br>浏览器执行javascript脚本时，会检查这个脚本属于哪个页面，如果不是同源页面，就不会被执行。</p>
<h4 id="2-为什么浏览器要限制跨域访问呢？"><a href="#2-为什么浏览器要限制跨域访问呢？" class="headerlink" title="2.为什么浏览器要限制跨域访问呢？"></a>2.为什么浏览器要限制跨域访问呢？</h4><p>原因就是安全问题：如果一个网页可以随意地访问另外一个网站的资源，那么就有可能在客户完全不知情的情况下出现安全问题。比如下面的操作就有安全问题：</p>
<ol>
<li>用户访问www.mybank.com ，登陆并进行网银操作，这时cookie啥的都生成并存放在浏览器</li>
<li>用户突然想起件事，并迷迷糊糊地访问了一个邪恶的网站 www.xiee.com</li>
<li>这时该网站就可以在它的页面中，拿到银行的cookie，比如用户名，登陆token等，然后发起对www.mybank.com 的操作。</li>
<li>如果这时浏览器不予限制，并且银行也没有做响应的安全处理的话，那么用户的信息有可能就这么泄露了。</li>
</ol>
<h4 id="3-什么是协议？"><a href="#3-什么是协议？" class="headerlink" title="3.什么是协议？"></a>3.什么是协议？</h4><p>简单来说，协议就是计算机与计算机之间通过网络实现通信时事先达成的一种”约定”，这种约定使那些由不同厂家生产的计算机，只要遵守相同的协议就能进行实现通信</p>
<h4 id="4-url"><a href="#4-url" class="headerlink" title="4.url"></a>4.url</h4><p>每个Web服务器资源都有一个名字，这样客户端就可以说明他们感兴趣的资源是什么了。服务器资源名被统一称为统一资源标识符（url）。URL就像邮箱地址一样，在世界范围内唯一标识并定位信息资源。</p>
<h4 id="5-域名-端口"><a href="#5-域名-端口" class="headerlink" title="5.域名  端口"></a>5.域名  端口</h4><p>在tcp中，你需要知道服务器的IP地址，以及与服务器上运行的特定软件相关的TCP端口号。<br>几个URL:<br><a href="http://207.200.83.29：80/index.html" target="_blank" rel="external">http://207.200.83.29：80/index.html</a><br><a href="http://www.netscape.com:80/index.html" target="_blank" rel="external">http://www.netscape.com:80/index.html</a><br><a href="http://www.netscape.com/index.html" target="_blank" rel="external">http://www.netscape.com/index.html</a><br>第一个URL使用了机器的IP地址，207.200.83.29以及端口号80。<br>第二个URL没有使用数字形式的IP地址，它使用的是文本形式形式的域名，或者称为主机名（www.netscape.com）。主机名就是IP地址比较人性化的别称。可以通过一种称为域名服务(DNS)的机制方便的将主机名转换为IP地址，这样所有问题就都解决了。第二章会介绍更多的关于DNS和URL的内容。<br>最后一个URL没有端口号。HTTP的URL中没有端口号时，可以假设默认端口号80。有了IP地址和端口号，客户端就可以方便的TCP/IP进行通信了。</p>
<h4 id="6-jquery跨域"><a href="#6-jquery跨域" class="headerlink" title="6.jquery跨域"></a>6.jquery跨域</h4><p>有很多种方法，目前先掌握一种</p>
<p>ajax本身是不可以跨域的，<br>通过产生一个script标签来实现跨域。因为script标签的src属性是没有跨域的限制的。</p>
<p>其实设置了dataType: ‘jsonp’后，$.ajax方法就和ajax XmlHttpRequest没什么关系了，取而代之的则是JSONP协议。JSONP是一个非官方的协议，它允许在服务器端集成Script tags返回至客户端，通过javascript callback的形式实现跨域访问。</p>
<p> ajax的跨域写法：</p>
<p>（其余写法和不跨域的一样）：</p>
<p>比如 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">/*当前网址是localhost:3000*/</div><div class="line">js代码</div><div class="line"> </div><div class="line">$.ajax(&#123;</div><div class="line">type:&quot;get&quot;,</div><div class="line">url:&quot;http://localhost:3000/showAll&quot;,/*url写异域的请求地址*/</div><div class="line">dataType:&quot;jsonp&quot;,/*加上datatype*/</div><div class="line">jsonpCallback:&quot;cb&quot;,/*设置一个回调函数，名字随便取，和下面的函数里的名字相同就行*/</div><div class="line">success:function()&#123;</div><div class="line">。。。</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">/*而在异域服务器上，*/</div><div class="line">app.js</div><div class="line">app.get(&apos;/showAll&apos;,students.showAll);/*这和不跨域的写法相同*/</div><div class="line"> </div><div class="line"> </div><div class="line">/*在异域服务器的showAll函数里，*/</div><div class="line"> </div><div class="line">var db = require(&quot;./database&quot;);</div><div class="line"> </div><div class="line">exports.showAll = function(req,res)&#123;</div><div class="line"> </div><div class="line">/**设置响应头允许ajax跨域访问**/</div><div class="line">res.setHeader(&quot;Access-Control-Allow-Origin&quot;,&quot;*&quot;);</div><div class="line">/*星号表示所有的异域请求都可以接受，*/</div><div class="line">res.setHeader(&quot;Access-Control-Allow-Methods&quot;,&quot;GET,POST&quot;);</div><div class="line"> </div><div class="line">var con = db.getCon();</div><div class="line">con.query(&quot;select * from t_students&quot;,function(error,rows)&#123;</div><div class="line">if(error)&#123;</div><div class="line">console.log(&quot;数据库出错：&quot;+error);</div><div class="line">&#125;else&#123;</div><div class="line">/*注意这里，返回的就是jsonP的回调函数名+数据了*/</div><div class="line">res.send(&quot;cb(&quot;+JSON.stringify(r)+&quot;)&quot;);</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2018/02/08/好用的css/" class="prev">PREV</a><a href="/2018/02/08/秒速5厘米影评(转)/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2020 <a href="http://yoursite.com">liuhaosen</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>